<div class="dashboard-layout">
    <!-- The sidebar component is now included here -->
    <app-admin-sidebar></app-admin-sidebar>

    <!-- Main Content -->
    <main class="main-content">
        
        <!-- Header -->
        <header class="header">
            <div class="welcome-banner">
                <h1 class="welcome-title">Welcome back, {{ userName }}!</h1>
            </div>
            <div class="relative">
                <select class="date-select">
                    <option>This Month</option>
                    <option>Last Month</option>
                    <option>This Year</option>
                </select>
                <div class="select-arrow">
                    <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                </div>
            </div>
        </header>

        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <h2 class="stat-title">Total Number of Thesis</h2>
                <p class="stat-value">{{ stats.totalThesis }}</p>
                <div class="stat-change">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13a1 1 0 102 0V9.414l1.293 1.293a1 1 0 001.414-1.414z" clip-rule="evenodd" /></svg>
                    <span>13.5% vs. last month</span>
                </div>
            </div>
            <!-- Other stat cards -->
            <div class="stat-card">
                <h2 class="stat-title">Total Number of Users</h2>
                <p class="stat-value">{{ stats.totalUsers }}</p>
                <div class="stat-change">
                   <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13a1 1 0 102 0V9.414l1.293 1.293a1 1 0 001.414-1.414z" clip-rule="evenodd" /></svg>
                    <span>4.7% vs. last month</span>
                </div>
            </div>
            <div class="stat-card">
                <h2 class="stat-title">Total Requests</h2>
                <p class="stat-value">{{ stats.totalRequests }}</p>
                 <div class="stat-change">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13a1 1 0 102 0V9.414l1.293 1.293a1 1 0 001.414-1.414z" clip-rule="evenodd" /></svg>
                    <span>4.7% vs. last month</span>
                </div>
            </div>
            <div class="stat-card">
                <h2 class="stat-title">Total Downloads</h2>
                <p class="stat-value">{{ stats.totalDownloads }}</p>
                <div class="stat-change">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13a1 1 0 102 0V9.414l1.293 1.293a1 1 0 001.414-1.414z" clip-rule="evenodd" /></svg>
                    <span>4.7% vs. last month</span>
                </div>
            </div>
        </div>

        <!-- Main Chart and Extra Card -->
        <div class="chart-grid">
            <div class="chart-container stat-card">
                <h2 class="stat-title mb-4">Total Number of User</h2>
                <canvas #userChart></canvas>
            </div>
            <div class="stat-card">
                <h2 class="stat-title">Registered Non-PUP User</h2>
                <p class="text-5xl font-bold mt-4">{{ stats.registeredNonPUP }}</p>
                 <div class="stat-change mt-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13a1 1 0 102 0V9.414l1.293 1.293a1 1 0 001.414-1.414z" clip-rule="evenodd" /></svg>
                    <span>4.7% vs. last month</span>
                </div>
            </div>
        </div>

        <!-- Bottom Lists -->
        <div class="lists-grid">
            <div class="stat-card">
                <h2 class="list-title">Top Accessed Keywords</h2>
                <div class="list-content">
                    <div *ngFor="let keyword of topKeywords; let i = index" class="list-item">
                        <span>{{ i + 1 }}. {{ keyword.name }}</span>
                        <span class="font-semibold">{{ keyword.access }}</span>
                    </div>
                </div>
            </div>
            <div class="stat-card">
                <h2 class="list-title">Documents per Department</h2>
                <div class="list-content">
                     <div *ngFor="let dept of docsPerDepartment; let i = index" class="list-item">
                        <span>{{ i + 1 }}. {{ dept.name }}</span>
                        <span class="font-semibold">{{ dept.total }}</span>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>
