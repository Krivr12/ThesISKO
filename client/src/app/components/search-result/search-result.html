<app-navbar></app-navbar>
<div class="container">
  <div class="content-card">
    <div class="card-header">
      <button type="button" class="return-link" (click)="onReturnClick()">
        &larr; Return
      </button>
    
      <div class="actions">
        <div class="citation-dropdown"
             [class.copied]="citationCopied">
          <button
            mat-stroked-button
            color="primary"
            class="citation-button"
            [class.copied]="citationCopied">
            <span *ngIf="!citationCopied">Copy Citation</span>
            <span *ngIf="citationCopied">{{copiedFormat}} Copied</span>
            <span class="dropdown-arrow">▼</span>
          </button>
          
          <div class="citation-options">
            <button class="citation-option" (click)="generateCitation('apa')">
              APA
            </button>
            <button class="citation-option" (click)="generateCitation('mla')">
              MLA
            </button>
          </div>
        </div>
        <button
          mat-stroked-button
          color="primary"
          class="request-button"
          (click)="$event.stopPropagation(); openRequestDialog()">
          Request Manuscript
        </button>
      </div>
    </div>
    


<!-- Dialog: Request full access -->
<ng-template #dlgRequestAccess let-dialogRef="dialogRef">
  <h2 mat-dialog-title>Request full access</h2>

  <mat-dialog-content class="dialog-body">
    <!-- Chapters -->
    <div class="dialog-section">
      <div class="section-title">Select chapters</div>
      <div class="checkbox-grid">
        <mat-checkbox
          *ngFor="let c of requestOptions"
          [checked]="selectedRequestChapters.has(c)"
          (change)="toggleRequestChapter(c, $event.checked)">
          {{ c }}
        </mat-checkbox>
      </div>
      <small class="hint">Tip: Select “All” if you need the entire manuscript.</small>
    </div>

    <!-- Purpose -->
    <div class="dialog-section">
      <div class="section-title">Purpose of request</div>
      <mat-form-field appearance="outline" class="w-100">
        <textarea matInput [(ngModel)]="requestPurpose"
                  placeholder="State your purpose"
                  rows="4"></textarea>
      </mat-form-field>
    </div>

    <!-- Email -->
    <div class="dialog-section">
      <div class="section-title">Your email</div>
      <mat-form-field appearance="outline" class="w-100">
        <input matInput [(ngModel)]="requestEmail" type="email" placeholder="name@example.com" />
      </mat-form-field>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button (click)="resetRequestDialog(); dialogRef.close()">Cancel</button>
    <button mat-raised-button color="accent" [disabled]="!formValid" (click)="confirmRequest(dialogRef)">
      Send request
    </button>
  </mat-dialog-actions>
</ng-template>



    <div class="main-title">
      <h1>{{ thesis.title }}</h1>
    </div>

    <div class="section">
      <h2 class="section-title">Abstract</h2>
      <p class="section-text">{{ thesis.abstract }}</p>
    </div>

    <div class="details-grid">
      <div class="details-column">
        <div class="detail-item">
          <p class="detail-label">Date of Publication</p>
          <p class="detail-value">
            {{ thesis.submitted_at | date:'MMMM d, y' }}
          </p>
        </div>
        <div class="detail-item">
          <p class="detail-label">Access Level</p>
          <p class="detail-value">{{ thesis.access_level }}</p>
        </div>
        <div class="detail-item">
          <p class="detail-label">Subject Categories</p>
          <p class="detail-value">{{ thesis.tags }}</p>
        </div>
      </div>
      <div class="details-column">
        <div class="detail-item">
          <p class="detail-label">Author's</p>
          <p class="detail-value">{{ thesis.authors }}</p>
        </div>
        <div class="detail-item">
          <p class="detail-label">Program</p>
          <p class="detail-value">{{ thesis.program }}</p>
        </div>
        <div class="detail-item">
          <p class="detail-label">Document Type</p>
          <p class="detail-value">{{ thesis.document_type }}</p>
        </div>
      </div>
    </div>
  </div>
</div>
<app-footer></app-footer>