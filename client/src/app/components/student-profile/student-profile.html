<app-navbar></app-navbar>

<div class="profile-container">
  <div class="profile-content">
    <p-card header="Edit Student Information" styleClass="profile-card">
      <form [formGroup]="profileForm" (ngSubmit)="onSave()">
        <div class="form-grid">
          <!-- Personal Information Section -->
          <div class="form-section">
            <h3>Personal Information</h3>
            
            <div class="form-row">
              <div class="form-field">
                <label for="firstName">First Name *</label>
                <input 
                  pInputText 
                  id="firstName" 
                  formControlName="firstName"
                  placeholder="Enter your first name"
                  [class.ng-invalid]="firstName?.invalid && firstName?.touched"
                />
                <small 
                  class="error-message" 
                  *ngIf="firstName?.invalid && firstName?.touched"
                >
                  First name is required (minimum 2 characters)
                </small>
              </div>

              <div class="form-field">
                <label for="lastName">Last Name *</label>
                <input 
                  pInputText 
                  id="lastName" 
                  formControlName="lastName"
                  placeholder="Enter your last name"
                  [class.ng-invalid]="lastName?.invalid && lastName?.touched"
                />
                <small 
                  class="error-message" 
                  *ngIf="lastName?.invalid && lastName?.touched"
                >
                  Last name is required (minimum 2 characters)
                </small>
              </div>
            </div>

            <div class="form-row">
              <div class="form-field">
                <label for="email">Email Address</label>
                <input 
                  pInputText 
                  id="email" 
                  formControlName="email"
                  placeholder="Your email address"
                  readonly
                  title="Email cannot be changed"
                />
                <small class="info-message">Email address cannot be modified</small>
              </div>

              <div class="form-field">
                <label for="studentId">Student ID *</label>
                <input 
                  pInputText 
                  id="studentId" 
                  formControlName="studentId"
                  placeholder="Enter your student ID"
                  [class.ng-invalid]="studentId?.invalid && studentId?.touched"
                />
                <small 
                  class="error-message" 
                  *ngIf="studentId?.invalid && studentId?.touched"
                >
                  Student ID is required
                </small>
              </div>
            </div>
          </div>

          <!-- Password Change Section -->
          <div class="form-section">
            <h3>Change Password</h3>
            
            <div class="form-row">
              <div class="form-field">
                <label for="currentPassword">Current Password *</label>
                <p-password 
                  id="currentPassword" 
                  formControlName="currentPassword"
                  placeholder="Enter your current password"
                  [toggleMask]="true"
                  [feedback]="false"
                  styleClass="w-full"
                  [class.ng-invalid]="currentPassword?.invalid && currentPassword?.touched"
                />
                <small 
                  class="error-message" 
                  *ngIf="currentPassword?.invalid && currentPassword?.touched"
                >
                  Current password is required
                </small>
              </div>

              <div class="form-field">
                <label for="newPassword">New Password *</label>
                <p-password 
                  id="newPassword" 
                  formControlName="newPassword"
                  placeholder="Enter your new password"
                  [toggleMask]="true"
                  [feedback]="true"
                  styleClass="w-full"
                  [class.ng-invalid]="newPassword?.invalid && newPassword?.touched"
                />
                <small 
                  class="error-message" 
                  *ngIf="newPassword?.invalid && newPassword?.touched"
                >
                  <span *ngIf="newPassword?.hasError('required')">New password is required</span>
                  <span *ngIf="newPassword?.hasError('minlength')">Password must be at least 6 characters long</span>
                </small>
              </div>
            </div>

            <div class="form-row">
              <div class="form-field">
                <label for="confirmPassword">Confirm New Password *</label>
                <p-password 
                  id="confirmPassword" 
                  formControlName="confirmPassword"
                  placeholder="Confirm your new password"
                  [toggleMask]="true"
                  [feedback]="false"
                  styleClass="w-full"
                  [class.ng-invalid]="confirmPassword?.invalid && confirmPassword?.touched"
                />
                <small 
                  class="error-message" 
                  *ngIf="confirmPassword?.invalid && confirmPassword?.touched"
                >
                  <span *ngIf="confirmPassword?.hasError('required')">Please confirm your password</span>
                  <span *ngIf="confirmPassword?.hasError('passwordMismatch')">Passwords do not match</span>
                </small>
              </div>

              <div class="form-field">
                <!-- Empty field for spacing -->
              </div>
            </div>

            <div class="password-info">
              <small class="info-message">
                <i class="pi pi-info-circle"></i>
                Password changes are only allowed after 3 days from the last change
              </small>
            </div>
          </div>

        </div>

        <!-- Action Buttons -->
        <div class="form-actions">
          <p-button 
            label="Cancel" 
            icon="pi pi-times" 
            severity="secondary"
            type="button"
            (click)="onCancel()"
            styleClass="cancel-button"
          >
          </p-button>
          
          <p-button 
            label="Save Changes" 
            icon="pi pi-check" 
            type="submit"
            [loading]="isLoading"
            [disabled]="profileForm.invalid || isLoading"
            [style]="{'background-color': '#ffd966', 'border-color': '#ffd966', 'color': '#800000'}"
          >
          </p-button>
        </div>
      </form>
    </p-card>
  </div>
</div>

<app-footer></app-footer>

<p-toast></p-toast>
