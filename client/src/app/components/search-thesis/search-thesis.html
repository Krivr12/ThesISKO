<app-navbar></app-navbar>
<div class="page-wrapper">
  <div class="search-page-container">
    <div class="search-bar-container">
      <input 
        type="text" 
        placeholder="Search by title, author, or keywords..." 
        class="search-input" 
        [(ngModel)]="searchQuery"
        (keyup.enter)="onSearch()"
      />
      <button class="search-button" (click)="onSearch()">Search</button>
    </div>

    <div class="results-layout">
      <aside class="filter-sidebar">
        <div class="filter-header">
          <h3 class="filter-title">Filter</h3>
          <button class="collapse-button" (click)="toggleFilters()">
            <span *ngIf="isCollapsed">Show Filters</span>
            <span *ngIf="!isCollapsed">Hide Filters</span>
          </button>
        </div>

        <div class="filter-options-wrapper" [ngClass]="{'collapsed': isCollapsed}">
          <div class="filter-group">
            <h4 class="filter-group-title">By Author</h4>
            <input 
              type="text" 
              placeholder="Author name..." 
              class="search-input" 
              [(ngModel)]="authorName"
              (keyup)="onAuthorChange()"
            />
          </div>

          <div class="filter-group">
            <h4 class="filter-group-title">By Year</h4>
            <select class="search-input" [(ngModel)]="selectedYear" (change)="onYearChange(selectedYear)">
              <option value="">All Years</option>
              <option *ngFor="let year of availableYears()" [value]="year">{{ year }}</option>
            </select>
          </div>

          <div class="filter-group">
            <h4 class="filter-group-title">By Tags</h4>
            <ul class="filter-list">
              <li *ngFor="let tag of predefinedTags()">
                <label class="filter-option">
                  <input 
                    type="checkbox" 
                    [checked]="selectedTags.includes(tag)"
                    (change)="onTagChange(tag, $event)"
                  >
                  {{ tag }}
                </label>
              </li>
            </ul>
          </div>

          <button class="search-button" (click)="clearFilters()" style="margin-top: 20px; width: 100%;">
            Clear All Filters
          </button>
        </div>
      </aside>

      <div class="search-results">
        <h2 class="results-count">{{ totalItems }} records found.</h2>

        <div class="result-card" *ngFor="let thesis of displayedTheses" (click)="viewThesis(thesis)">
          <h3 class="thesis-title">{{ thesis.title }}</h3>
          <p class="thesis-meta">By: {{ thesis.author }} | Year: {{ thesis.year }}</p>
          <div class="tags-container">
            <span class="tag tag-year">{{ thesis.year }}</span>
            <span *ngFor="let keyword of thesis.keywords" class="tag tag-keywords">
              {{ keyword }}
            </span>
          </div>
        </div>

<!-- paginator component -->
        <div class="paginator">
          <button
            (click)="goToPage(currentPage - 1)"
            [disabled]="currentPage === 1"
            class="paginator-button nav-button"
          >
            &lt;&lt;
          </button>
          <button
            (click)="goToPage(currentPage - 1)"
            [disabled]="currentPage === 1"
            class="paginator-button nav-button"
          >
            &lt;
          </button>

          <ng-container *ngIf="pages[0] > 1">
            <button
              (click)="goToPage(1)"
              [ngClass]="{'active': currentPage === 1}"
              class="paginator-button"
            >
              1
            </button>
            <span *ngIf="pages[0] > 2" class="paginator-ellipsis">...</span>
          </ng-container>

          <button
            *ngFor="let page of pages"
            (click)="goToPage(page)"
            [ngClass]="{'active': currentPage === page}"
            class="paginator-button"
          >
            {{ page }}
          </button>

          <ng-container *ngIf="pages[pages.length - 1] < totalPages">
            <span *ngIf="pages[pages.length - 1] < totalPages - 1" class="paginator-ellipsis">...</span>
            <button
              (click)="goToPage(totalPages)"
              [ngClass]="{'active': currentPage === totalPages}"
              class="paginator-button"
            >
              {{ totalPages }}
            </button>
          </ng-container>

          <button
            (click)="goToPage(currentPage + 1)"
            [disabled]="currentPage === totalPages"
            class="paginator-button nav-button"
          >
            &gt;
          </button>
          <button
            (click)="goToPage(currentPage + 1)"
            [disabled]="currentPage === totalPages"
            class="paginator-button nav-button"
          >
            &gt;&gt;
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<app-footer> </app-footer>