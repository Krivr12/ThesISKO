<app-navbar></app-navbar>
<div class="page-wrapper">
  <div class="search-page-container">
    <div class="search-bar-container">
      <input 
        type="text" 
        placeholder="Search by title, author, or keywords..." 
        class="search-input" 
        [(ngModel)]="searchQuery"
        (keyup.enter)="onSearch()"
      />
      <button class="search-button" (click)="onSearch()">Search</button>
    </div>

    <div class="results-layout">
      <aside class="filter-sidebar">
        <div class="filter-header">
          <h3 class="filter-title">Filter</h3>
          <button class="collapse-button" (click)="toggleFilters()">
            <span *ngIf="isCollapsed">Show Filters</span>
            <span *ngIf="!isCollapsed">Hide Filters</span>
          </button>
        </div>

        <div class="filter-options-wrapper" [ngClass]="{'collapsed': isCollapsed}">
          <div class="filter-group">
            <h4 class="filter-group-title">By Author</h4>
            <input 
              type="text" 
              placeholder="Author name..." 
              class="search-input" 
              [(ngModel)]="authorName"
              (keyup)="onAuthorChange()"
            />
          </div>

          <div class="filter-group">
            <h4 class="filter-group-title">By Year</h4>
            <select class="search-input" [(ngModel)]="selectedYear" (change)="onYearChange(selectedYear)">
              <option value="">All Years</option>
              <option *ngFor="let year of availableYears()" [value]="year">{{ year }}</option>
            </select>
          </div>

          <div class="filter-group">
            <h4 class="filter-group-title">By Tags</h4>
            <ul class="filter-list">
              <li *ngFor="let tag of predefinedTags()">
                <label class="filter-option">
                  <input 
                    type="checkbox" 
                    [checked]="selectedTags.includes(tag)"
                    (change)="onTagChange(tag, $event)"
                  >
                  {{ tag }}
                </label>
              </li>
            </ul>
          </div>

          <button class="search-button" (click)="clearFilters()" style="margin-top: 20px; width: 100%;">
            Clear All Filters
          </button>
        </div>
      </aside>

      <div class="search-results">
        <h2 class="results-count">{{ totalItems }} records found.</h2>

        <div class="result-card" *ngFor="let thesis of displayedTheses" (click)="viewThesis(thesis)">
          <h3 class="thesis-title">{{ thesis.title }}</h3>
          <p class="thesis-meta">
            By: {{ thesis.authors.join(', ') }} | Year: {{ thesis.submitted_at | date:'yyyy' }}
          </p>
          <div class="tags-container">
            <span *ngFor="let tag of thesis.tags" class="tag tag-keywords">
              {{ tag }}
            </span>
          </div>
        </div>

        
        <mat-paginator
        class="paginator"
        [length]="totalItems"
        [pageIndex]="currentPage - 1"
        [pageSize]="itemsPerPage"
        [pageSizeOptions]="[5, 10, 20]"
        (page)="onPage($event)">
      </mat-paginator>
      

      </div>
    </div>
  </div>
</div>

<app-footer></app-footer>
